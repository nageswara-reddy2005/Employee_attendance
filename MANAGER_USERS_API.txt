â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              MANAGER USERS DATA API ENDPOINTS                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… NEW ENDPOINTS CREATED
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Two new API endpoints have been added for managers to retrieve user data:

1. GET /api/dashboard/manager/users/all
   - Get all employees with attendance data
   - Returns list of all users with today's status and monthly summary

2. GET /api/dashboard/manager/users/:userId
   - Get detailed data for a specific user
   - Returns user info, attendance statistics, and recent attendance records

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“‹ ENDPOINT 1: GET ALL USERS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Endpoint:
  GET /api/dashboard/manager/users/all

Authentication:
  Required: YES (Bearer token)
  Role: Manager only

Description:
  Retrieves all employees with their basic info and current attendance data

Response Example:
{
  "total": 15,
  "users": [
    {
      "_id": "507f1f77bcf86cd799439011",
      "name": "Employee 1",
      "email": "employee1@example.com",
      "employeeId": "EMP001",
      "department": "HR",
      "phone": "+1234567890",
      "createdAt": "2024-11-30T10:00:00Z",
      "todayStatus": "present",
      "todayCheckIn": "2024-11-30T09:15:00Z",
      "todayCheckOut": "2024-11-30T17:30:00Z",
      "monthSummary": {
        "present": 18,
        "absent": 2,
        "late": 1,
        "halfDay": 0,
        "totalHours": 144.5
      }
    },
    ...more users
  ]
}

Response Fields:
  - total: Total number of employees
  - users: Array of employee objects
    * _id: User ID
    * name: Employee name
    * email: Employee email
    * employeeId: Employee ID
    * department: Department name
    * phone: Phone number
    * createdAt: Account creation date
    * todayStatus: Today's attendance status (present, absent, late, not-checked-in)
    * todayCheckIn: Today's check-in time
    * todayCheckOut: Today's check-out time
    * monthSummary: This month's attendance summary
      - present: Days present
      - absent: Days absent
      - late: Days late
      - halfDay: Half days
      - totalHours: Total hours worked

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“‹ ENDPOINT 2: GET USER DETAILS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Endpoint:
  GET /api/dashboard/manager/users/:userId

Parameters:
  - userId: MongoDB user ID (required)

Authentication:
  Required: YES (Bearer token)
  Role: Manager only

Description:
  Retrieves detailed information for a specific user including all attendance records

Response Example:
{
  "user": {
    "_id": "507f1f77bcf86cd799439011",
    "name": "Employee 1",
    "email": "employee1@example.com",
    "employeeId": "EMP001",
    "department": "HR",
    "phone": "+1234567890",
    "createdAt": "2024-11-30T10:00:00Z"
  },
  "stats": {
    "totalDays": 30,
    "present": 25,
    "absent": 2,
    "late": 2,
    "halfDay": 1,
    "totalHours": 200.5,
    "attendancePercentage": 83
  },
  "recentAttendance": [
    {
      "_id": "507f1f77bcf86cd799439012",
      "userId": "507f1f77bcf86cd799439011",
      "date": "2024-11-30",
      "checkInTime": "2024-11-30T09:15:00Z",
      "checkOutTime": "2024-11-30T17:30:00Z",
      "status": "present",
      "totalHours": 8.25
    },
    ...more records (last 30)
  ]
}

Response Fields:
  - user: User information
    * _id: User ID
    * name: Employee name
    * email: Employee email
    * employeeId: Employee ID
    * department: Department name
    * phone: Phone number
    * createdAt: Account creation date
  
  - stats: Attendance statistics
    * totalDays: Total attendance records
    * present: Days present
    * absent: Days absent
    * late: Days late
    * halfDay: Half days
    * totalHours: Total hours worked
    * attendancePercentage: Attendance percentage
  
  - recentAttendance: Last 30 attendance records
    * _id: Attendance record ID
    * userId: User ID
    * date: Attendance date (YYYY-MM-DD)
    * checkInTime: Check-in timestamp
    * checkOutTime: Check-out timestamp
    * status: Attendance status
    * totalHours: Hours worked

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ§ª TESTING THE ENDPOINTS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Using cURL:

1. Get all users:
   curl -X GET http://localhost:5000/api/dashboard/manager/users/all \
     -H "Authorization: Bearer YOUR_TOKEN" \
     -H "Content-Type: application/json"

2. Get specific user details:
   curl -X GET http://localhost:5000/api/dashboard/manager/users/USER_ID \
     -H "Authorization: Bearer YOUR_TOKEN" \
     -H "Content-Type: application/json"

Using JavaScript (Axios):

1. Get all users:
   const response = await axiosInstance.get('/dashboard/manager/users/all');
   console.log(response.data);

2. Get specific user:
   const response = await axiosInstance.get(`/dashboard/manager/users/${userId}`);
   console.log(response.data);

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âš ï¸  ERROR RESPONSES
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

401 Unauthorized:
  {
    "error": "Unauthorized"
  }
  Cause: Missing or invalid token

403 Forbidden:
  {
    "error": "Access denied"
  }
  Cause: User is not a manager

404 Not Found:
  {
    "error": "User not found"
  }
  Cause: User ID doesn't exist (for /users/:userId endpoint)

500 Internal Server Error:
  {
    "error": "Failed to fetch users data: [error message]"
  }
  Cause: Server error - check backend logs

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“ FILES MODIFIED
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. backend/src/controllers/dashboardController.js
   - Added getAllUsers() function
   - Added getUserDetails() function
   - Updated module.exports

2. backend/src/routes/dashboardRoutes.js
   - Added GET /manager/users/all route
   - Added GET /manager/users/:userId route
   - Updated imports

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… FEATURES
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ“ Get all employees in one request
âœ“ See today's status for each employee
âœ“ View monthly attendance summary
âœ“ Get detailed statistics for specific user
âœ“ View last 30 attendance records
âœ“ Calculate attendance percentage
âœ“ Manager-only access (role-based)
âœ“ Comprehensive error handling
âœ“ Detailed console logging for debugging

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸš€ USAGE IN FRONTEND
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Example React component:

import { useEffect, useState } from 'react';
import axiosInstance from '../api/axios';

function AllEmployees() {
  const [employees, setEmployees] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    fetchAllEmployees();
  }, []);

  const fetchAllEmployees = async () => {
    try {
      const response = await axiosInstance.get('/dashboard/manager/users/all');
      setEmployees(response.data.users);
    } catch (error) {
      console.error('Error fetching employees:', error);
    } finally {
      setLoading(false);
    }
  };

  const viewUserDetails = async (userId) => {
    try {
      const response = await axiosInstance.get(`/dashboard/manager/users/${userId}`);
      console.log('User details:', response.data);
      // Display user details modal or page
    } catch (error) {
      console.error('Error fetching user details:', error);
    }
  };

  return (
    <div>
      {loading ? <p>Loading...</p> : (
        <table>
          <thead>
            <tr>
              <th>Name</th>
              <th>Email</th>
              <th>Department</th>
              <th>Today Status</th>
              <th>Present Days</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            {employees.map(emp => (
              <tr key={emp._id}>
                <td>{emp.name}</td>
                <td>{emp.email}</td>
                <td>{emp.department}</td>
                <td>{emp.todayStatus}</td>
                <td>{emp.monthSummary.present}</td>
                <td>
                  <button onClick={() => viewUserDetails(emp._id)}>
                    View Details
                  </button>
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      )}
    </div>
  );
}

export default AllEmployees;

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Version: 1.0.0
Last Updated: November 2024

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              âœ… MANAGER USERS API READY TO USE! âœ…                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
